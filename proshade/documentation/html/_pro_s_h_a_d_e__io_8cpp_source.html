<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_io.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.5.4 (MAR 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__io_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ProSHADE_io.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_pro_s_h_a_d_e__io_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//==================================================== ProSHADE</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_pro_s_h_a_d_e__io_8hpp.html">ProSHADE_io.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">   32</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( std::string fName )</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">//================================================ Try reading the file using Gemmi</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        gemmi::Structure structure                    = gemmi::read_structure ( gemmi::MaybeGzipped ( fName ) );</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">catch</span> ( std::runtime_error&amp; e )</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">//============================================ Read failed. Done</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//================================================ Read successfull. Done</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#ae496132c658b22a5abb5d7aaca5e1f56">   57</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ae496132c658b22a5abb5d7aaca5e1f56">ProSHADE_internal_io::isFileMAP</a> ( std::string fName )</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        map.read_ccp4                                 ( gemmi::MaybeGzipped (fName.c_str() ) );</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">catch</span> ( std::runtime_error&amp; e )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">//============================================ Failed to read the map</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">  103</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a> ( gemmi::Ccp4&lt;float&gt; *map, proshade_unsign *xDimInds, proshade_unsign *yDimInds, proshade_unsign *zDimInds, proshade_single *xDim, proshade_single *yDim, proshade_single *zDim, proshade_single *aAng, proshade_single *bAng, proshade_single *cAng, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom, proshade_signed *xAxOrigin, proshade_signed *yAxOrigin, proshade_signed *zAxOrigin, proshade_unsign *xAxOrder, proshade_unsign *yAxOrder, proshade_unsign *zAxOrder, proshade_unsign *xGridInds, proshade_unsign *yGridInds, proshade_unsign *zGridInds )</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">//================================================ Read in the map file header</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   *xDimInds                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 1  ) );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   *yDimInds                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 2  ) );</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   *zDimInds                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 3  ) );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   *xFrom                                             = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 5  ) );</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   *yFrom                                             = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 6  ) );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   *zFrom                                             = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 7  ) );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   *xDim                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 11 ) );</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   *yDim                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 12 ) );</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   *zDim                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 13 ) );</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   *aAng                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 14 ) );</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   *bAng                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 15 ) );</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   *cAng                                              = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( map-&gt;header_float ( 16 ) );</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   *xAxOrigin                                         = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 50 ) ) + (*xFrom);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   *yAxOrigin                                         = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 51 ) ) + (*yFrom);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   *zAxOrigin                                         = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 52 ) ) + (*zFrom);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   *xAxOrder                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 17 ) );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   *yAxOrder                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 18 ) );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   *zAxOrder                                          = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 19 ) );</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   *xGridInds                                         = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 8  ) );</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   *yGridInds                                         = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 9  ) );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   *zGridInds                                         = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( map-&gt;header_i32   ( 10 ) );</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">//================================================ Deal with sampling being different from cell size</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> ( *xGridInds != *xDimInds )</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        *xDim                                         = *xDim * ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *xDimInds ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *xGridInds ) );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        *xGridInds                                    = *xDimInds;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> ( *yGridInds != *yDimInds )</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        *yDim                                         = *yDim * ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *yDimInds ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *yGridInds ) );</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        *yGridInds                                    = *yDimInds;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> ( *zGridInds != *zDimInds )</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        *zDim                                         = *zDim * ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *zDimInds ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( *zGridInds ) );</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        *zGridInds                                    = *zDimInds;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    return ;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a> ( gemmi::Ccp4&lt;float&gt; *gemmiMap, proshade_double*&amp; map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder )</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">//================================================ Allocate internal variables</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    proshade_unsign *axOrdArr                         = <span class="keyword">new</span> proshade_unsign[3];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    proshade_unsign *axDimArr                         = <span class="keyword">new</span> proshade_unsign[3];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//================================================ Check memory allocation and fill in values</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( axOrdArr, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( axDimArr, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    axDimArr[0]                                       = xDimInds;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    axDimArr[1]                                       = yDimInds;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    axDimArr[2]                                       = zDimInds;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//================================================ Allocate the ProSHADE internal map variable memory</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    map                                               = <span class="keyword">new</span> proshade_double [xDimInds * yDimInds * zDimInds];</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( map, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//================================================ Copy read in data to internal map variable</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> ( axOrdArr[0] = 0; axOrdArr[0] &lt; axDimArr[xAxOrder-1]; axOrdArr[0]++ )</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">for</span> ( axOrdArr[1] = 0; axOrdArr[1] &lt; axDimArr[yAxOrder-1]; axOrdArr[1]++ )</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">for</span> ( axOrdArr[2] = 0; axOrdArr[2] &lt; axDimArr[zAxOrder-1]; axOrdArr[2]++ )</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                arrPos                                = axOrdArr[2]  + axDimArr[zAxOrder-1] * ( axOrdArr[1]  + axDimArr[yAxOrder-1] * axOrdArr[0] );</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                map[arrPos]                           = gemmiMap-&gt;grid.get_value_q( axOrdArr[xAxOrder-1], axOrdArr[yAxOrder-1], axOrdArr[zAxOrder-1] );</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//================================================ Release internal variables memory</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">delete</span>[] axDimArr;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">delete</span>[] axOrdArr;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    return ;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">  242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a> ( gemmi::Ccp4&lt;float&gt; *map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_single xDim, proshade_single yDim, proshade_single zDim, proshade_single aAng, proshade_single bAng, proshade_single cAng, proshade_signed xFrom, proshade_signed yFrom, proshade_signed zFrom, proshade_signed xAxOrigin, proshade_signed yAxOrigin, proshade_signed zAxOrigin, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder, proshade_unsign xGridInds, proshade_unsign yGridInds, proshade_unsign zGridInds, std::string title, <span class="keywordtype">int</span> mode )</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//================================================ Fill in the map file header</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    map-&gt;set_header_i32                               ( 1 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( xDimInds ) );       <span class="comment">// Number of columns in 3D data array (fast axis)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    map-&gt;set_header_i32                               ( 2 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( yDimInds ) );       <span class="comment">// Number of columns in 3D data array (medium axis)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    map-&gt;set_header_i32                               ( 3 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( zDimInds ) );       <span class="comment">// Number of columns in 3D data array (slow axis)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    map-&gt;set_header_i32                               ( 4 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( mode ) );           <span class="comment">// Map mode</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    map-&gt;set_header_i32                               ( 5 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( xFrom ) );          <span class="comment">// Starting index (fast axis)</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    map-&gt;set_header_i32                               ( 6 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( yFrom ) );          <span class="comment">// Starting index (medium axis)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    map-&gt;set_header_i32                               ( 7 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( zFrom ) );          <span class="comment">// Starting index (slow axis)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    map-&gt;set_header_i32                               ( 8 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( xGridInds ) );      <span class="comment">// Grid sampling (fast axis)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    map-&gt;set_header_i32                               ( 9 , <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( yGridInds ) );      <span class="comment">// Grid sampling (medium axis)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    map-&gt;set_header_i32                               ( 10, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( zGridInds ) );      <span class="comment">// Grid sampling (slow axis)</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    map-&gt;set_header_float                             ( 11, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( xDim ) );           <span class="comment">// Grid dimension in Angstrom (fast axis)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    map-&gt;set_header_float                             ( 12, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( yDim ) );           <span class="comment">// Grid dimension in Angstrom (medium axis)</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    map-&gt;set_header_float                             ( 13, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( zDim ) );           <span class="comment">// Grid dimension in Angstrom (slow axis)</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    map-&gt;set_header_float                             ( 14, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( aAng ) );           <span class="comment">// Alpha angle in degrees</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    map-&gt;set_header_float                             ( 15, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( bAng ) );           <span class="comment">// Beta angle in degrees</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    map-&gt;set_header_float                             ( 16, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>   ( cAng ) );           <span class="comment">// Gamma angle in degrees</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    map-&gt;set_header_i32                               ( 17, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( xAxOrder ) );       <span class="comment">// MAPC</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    map-&gt;set_header_i32                               ( 18, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( yAxOrder ) );       <span class="comment">// MAPR</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    map-&gt;set_header_i32                               ( 19, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( zAxOrder ) );       <span class="comment">// MAPS</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> ( map-&gt;grid.spacegroup ) { map-&gt;set_header_i32 ( 23, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( map-&gt;grid.spacegroup-&gt;ccp4 ) ); } <span class="comment">// Space group</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">else</span>                        { map-&gt;set_header_i32 ( 23, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( 1 ) ); }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    map-&gt;set_header_i32                               ( 24, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( map-&gt;grid.spacegroup-&gt;operations().order() * 80 ) ); <span class="comment">// NSYMBT - size of extended header (which follows main header) in bytes</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    map-&gt;set_header_str                               ( 27, <span class="stringliteral">&quot;CCP4&quot;</span> );                                  <span class="comment">// Code for the type of extended header</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    map-&gt;set_header_i32                               ( 28, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( 20140 ) );          <span class="comment">// Version</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    map-&gt;set_header_i32                               ( 50, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( xAxOrigin ) );      <span class="comment">// Origin of the map (fast axis)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    map-&gt;set_header_i32                               ( 51, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( yAxOrigin ) );      <span class="comment">// Origin of the map (medium axis)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    map-&gt;set_header_i32                               ( 52, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( zAxOrigin ) );      <span class="comment">// Origin of the map (slow axis)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    map-&gt;set_header_str                               ( 53, <span class="stringliteral">&quot;MAP&quot;</span> );                                   <span class="comment">// File format</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> ( gemmi::is_little_endian() ) { map-&gt;set_header_i32 ( 54, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( 0x00004144 ) ); }       <span class="comment">// Machine stamp encoding byte ordering of data</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">else</span>                             { map-&gt;set_header_i32 ( 54, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( 0x11110000 ) ); }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    map-&gt;set_header_i32                               ( 56, <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> ( 1 ) );                       <span class="comment">// Number of labels used</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    std::memset                                       ( <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span> ( &amp;(map-&gt;ccp4_header.at( 56 )) ), <span class="charliteral">&#39; &#39;</span>, 800 + map-&gt;grid.spacegroup-&gt;operations().order() * 80); <span class="comment">// 56 is used because the vector is indexed from 0</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    map-&gt;set_header_str                               ( 57, title );                                            <span class="comment">// Title</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    return ;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">  292</a></span>&#160;ProSHADE_internal_io::InputType <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a> ( std::string fName )</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//================================================ Try readin as PDB</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">isFilePDB</a> ( fName ) )</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">return</span>                                        ( PDB );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//================================================ If not, try readin as MAP</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ae496132c658b22a5abb5d7aaca5e1f56">isFileMAP</a> ( fName ) )</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">return</span>                                        ( MAP );</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">//================================================ No luck? UNKNOWN it is ...</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">return</span>                                            ( UNKNOWN );</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">  334</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a> ( proshade_double trsX1, proshade_double trsY1, proshade_double trsZ1, proshade_double eulA, proshade_double eulB, proshade_double eulG, proshade_double trsX2, proshade_double trsY2, proshade_double trsZ2, std::string fileName )</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">//================================================ Open file for writing</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    std::ofstream jsonFile;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    jsonFile.open                                     ( fileName );</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">//================================================ Check file opening success</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> ( !jsonFile.is_open( ) )</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Failed to open JSON output file.&quot;</span>, <span class="stringliteral">&quot;E000056&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Failed to open json file to which the rotation and\n                    : translation would be written into. Most likely cause is\n                    : lack of rights to write in the current folder.&quot;</span> );</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//================================================ Get rotation matrix from Euler angles</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eulA, eulB, eulG, rotMat );</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//================================================ Write the info</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;   \&quot;translationToOrigin\&quot; :           [ &quot;</span> &lt;&lt; trsX1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; trsY1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; trsZ1 &lt;&lt; <span class="stringliteral">&quot; ], \n&quot;</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;   \&quot;rotationMatrix:\&quot; :               [ &quot;</span> &lt;&lt; rotMat[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[2] &lt;&lt; <span class="stringliteral">&quot;, \n&quot;</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;                                         &quot;</span> &lt;&lt; rotMat[3] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[4] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[5] &lt;&lt; <span class="stringliteral">&quot;, \n&quot;</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;                                         &quot;</span> &lt;&lt; rotMat[6] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[7] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rotMat[8] &lt;&lt; <span class="stringliteral">&quot;], \n&quot;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;   \&quot;translationFromRotCenToOverlay\&quot; : [ &quot;</span> &lt;&lt; trsX2 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; trsY2 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; trsZ2 &lt;&lt; <span class="stringliteral">&quot; ] \n&quot;</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    jsonFile &lt;&lt; <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">//================================================ Close file</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    jsonFile.close                                    ( );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    return ;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_abc5e6a82b6b44e3666abfc190dc0bc64"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a></div><div class="ttdeci">bool isFilePDB(std::string fName)</div><div class="ttdoc">Function determining if the input data type is PDB.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00032">ProSHADE_io.cpp:32</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01005">ProSHADE_maths.cpp:1005</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_ae496132c658b22a5abb5d7aaca5e1f56"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#ae496132c658b22a5abb5d7aaca5e1f56">ProSHADE_internal_io::isFileMAP</a></div><div class="ttdeci">bool isFileMAP(std::string fName)</div><div class="ttdoc">Function determining if the input data type is MAP.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00057">ProSHADE_io.cpp:57</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a63ae2cc7f413d224e5d651ed579e9afb"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a></div><div class="ttdeci">InputType figureDataType(std::string fName)</div><div class="ttdoc">Function determining input data type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00292">ProSHADE_io.cpp:292</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__io_8hpp_html"><div class="ttname"><a href="_pro_s_h_a_d_e__io_8hpp.html">ProSHADE_io.hpp</a></div><div class="ttdoc">This header file declares all the functions required for low level file format access.</div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_ad93f9644c5b132193b4ddd282f50abce"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a></div><div class="ttdeci">void readInMapData(gemmi::Ccp4&lt; float &gt; *gemmiMap, proshade_double *&amp;map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder)</div><div class="ttdoc">This function converts the gemmi Ccp4 object data to ProSHADE internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00172">ProSHADE_io.cpp:172</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9f714e15a7bc56dbe846fda6bb1d9c9e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a></div><div class="ttdeci">void writeRotationTranslationJSON(proshade_double trsX1, proshade_double trsY1, proshade_double trsZ1, proshade_double eulA, proshade_double eulB, proshade_double eulG, proshade_double trsX2, proshade_double trsY2, proshade_double trsZ2, std::string fileName)</div><div class="ttdoc">Function for writing out the optimal rotation and translation into a JSON file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00334">ProSHADE_io.cpp:334</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a2e438f3d348e3e065f798031d5a33d09"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a></div><div class="ttdeci">void writeOutMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_single xDim, proshade_single yDim, proshade_single zDim, proshade_single aAng, proshade_single bAng, proshade_single cAng, proshade_signed xFrom, proshade_signed yFrom, proshade_signed zFrom, proshade_signed xAxOrigin, proshade_signed yAxOrigin, proshade_signed zAxOrigin, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder, proshade_unsign xGridInds, proshade_unsign yGridInds, proshade_unsign zGridInds, std::string title, int mode)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00242">ProSHADE_io.cpp:242</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00065">ProSHADE_misc.hpp:65</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9677e06f0781855b9046aab1b3638831"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a></div><div class="ttdeci">void readInMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign *xDimInds, proshade_unsign *yDimInds, proshade_unsign *zDimInds, proshade_single *xDim, proshade_single *yDim, proshade_single *zDim, proshade_single *aAng, proshade_single *bAng, proshade_single *cAng, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom, proshade_signed *xAxOrigin, proshade_signed *yAxOrigin, proshade_signed *zAxOrigin, proshade_unsign *xAxOrder, proshade_unsign *yAxOrder, proshade_unsign *zAxOrder, proshade_unsign *xGridInds, proshade_unsign *yGridInds, proshade_unsign *zGridInds)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00103">ProSHADE_io.cpp:103</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__io_8cpp.html">ProSHADE_io.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
